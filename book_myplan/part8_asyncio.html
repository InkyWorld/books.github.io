<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8.1 Asyncio Advanced ‚Äî ScaleTrade</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="book-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="logo">
                    <div class="logo-icon">üìà</div>
                    <span>ScaleTrade</span>
                </a>
            </div>
            <nav class="sidebar-nav">
    <div class="nav-section">
        <div class="nav-section-title">Intro</div>
        <a href="index.html" class="nav-link">üè† –ì–ª–∞–≤–Ω–∞—è</a>
        <a href="setup.html" class="nav-link">üõ† Setup</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 0: Fundamentals</div>
        <a href="part0_internals.html" class="nav-link">0.1 Internals</a>
        <a href="part0_networking.html" class="nav-link">0.2 Networking</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 1: Postgres</div>
        <a href="part1_schema.html" class="nav-link">1.1 Schema</a>
        <a href="part1_indexes.html" class="nav-link">1.2 Indexes</a>
        <a href="part1_transactions.html" class="nav-link">1.3 Transactions</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 2: Litestar</div>
        <a href="part2_litestar.html" class="nav-link">2.1 Framework</a>
        <a href="part2_dishka.html" class="nav-link">2.2 DI (Dishka)</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 3: Brokers</div>
        <a href="part3_redis.html" class="nav-link">3.1 Redis</a>
        <a href="part3_faststream.html" class="nav-link">3.2 FastStream</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 4: Quality</div>
        <a href="part4_testing.html" class="nav-link">4.1 Pytest</a>
        <a href="part4_resiliency.html" class="nav-link">4.2 Resilience</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 5: Observability</div>
        <a href="part5_clickhouse.html" class="nav-link">5.1 Clickhouse</a>
        <a href="part5_logging.html" class="nav-link">5.2 Structured Logs</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 6: Django</div>
        <a href="part6_django.html" class="nav-link">6.1 ORM</a>
        <a href="part6_migrations.html" class="nav-link">6.2 Migrations</a>
        <a href="part6_quality.html" class="nav-link">6.3 Quality</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 7: Microservices</div>
        <a href="part7_grpc.html" class="nav-link">7.1 gRPC</a>
        <a href="part7_graphql.html" class="nav-link">7.2 GraphQL</a>
        <a href="part7_federation.html" class="nav-link">7.3 Federation</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 8: Async</div>
        <a href="part8_asyncio.html" class="nav-link active">8.1 Asyncio</a>
        <a href="part8_celery.html" class="nav-link">8.2 Celery</a>
        <a href="part8_dramatiq.html" class="nav-link">8.3 Dramatiq</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 9: API</div>
        <a href="part9_restdesign.html" class="nav-link">9.1 REST Design</a>
        <a href="part9_idempotency.html" class="nav-link">9.2 Idempotency</a>
        <a href="part9_openapi.html" class="nav-link">9.3 OpenAPI</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 10: Culture</div>
        <a href="part10_git.html" class="nav-link">10.1 Git</a>
        <a href="part10_commits.html" class="nav-link">10.2 Commits</a>
        <a href="part10_codereview.html" class="nav-link">10.3 Post-Review</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 11: Security</div>
        <a href="part11_oauth.html" class="nav-link">11.1 OAuth2</a>
        <a href="part11_vault.html" class="nav-link">11.2 Vault</a>
        <a href="part11_owasp.html" class="nav-link">11.3 OWASP</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 12: Kubernetes</div>
        <a href="part12_kubernetes.html" class="nav-link">12.1 K8s Basics</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 13: High Load</div>
        <a href="part13_profiling.html" class="nav-link">13.1 Profiling</a>
        <a href="part13_caching.html" class="nav-link">13.2 Caching</a>
        <a href="part13_loadbalancing.html" class="nav-link">13.3 Load Balancing</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 14: ML Ops</div>
        <a href="part14_mlflow.html" class="nav-link">14.1 MLflow</a>
        <a href="part14_embeddings.html" class="nav-link">14.2 Embeddings</a>
        <a href="part14_llm.html" class="nav-link">14.3 LLM</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 15: Debugging</div>
        <a href="part15_debugging.html" class="nav-link">15.1 Debugging</a>
        <a href="part15_postmortem.html" class="nav-link">15.2 Postmortem</a>
        <a href="part15_chaos.html" class="nav-link">15.3 Chaos Eng</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 16: DB Advanced</div>
        <a href="part16_indexes.html" class="nav-link">16.1 Indexes Deep</a>
        <a href="part16_isolation.html" class="nav-link">16.2 Isolation</a>
        <a href="part16_sharding.html" class="nav-link">16.3 Sharding</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 17: System Design</div>
        <a href="part17_circuit.html" class="nav-link">17.1 Circuit Breaker</a>
        <a href="part17_ratelimit.html" class="nav-link">17.2 Rate Limit</a>
        <a href="part17_distlock.html" class="nav-link">17.3 Dist Lock</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 18: Soft Skills</div>
        <a href="part18_estimation.html" class="nav-link">18.1 Estimation</a>
        <a href="part18_burnout.html" class="nav-link">18.2 Burnout</a>
        <a href="part18_interview.html" class="nav-link">18.3 Interview</a>
    </div>
</nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="breadcrumb">
                    <a href="index.html">ScaleTrade</a>
                    <span>/</span>
                    <span>–ß–∞—Å—Ç—å 8</span>
                    <span>/</span>
                    <span>8.1 Asyncio</span>
                </div>
            </header>

            <div class="page-content">
                <h1>–ú–æ–¥—É–ª—å 8.1: Asyncio Advanced</h1>
                <p class="lead">Asyncio –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ await. –≠—Ç–æ –≥—Ä–∞—Ü–∏–æ–∑–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ —Ñ–æ–Ω–µ.</p>

                <h2>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Event Loop?</h2>
                <p>–í –æ—Å–Ω–æ–≤–µ Asyncio –ª–µ–∂–∏—Ç –ø–∞—Ç—Ç–µ—Ä–Ω <strong>Reactor</strong>. –≠—Ç–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: "–ì–æ—Ç–æ–≤ –ª–∏ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —Å–æ–∫–µ—Ç –∫ —á—Ç–µ–Ω–∏—é/–∑–∞–ø–∏—Å–∏?".</p>
                <div class="card">
                    <h4>üèóÔ∏è –ú–µ—Ö–∞–Ω–∏–∫–∞ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º (OS Level)</h4>
                    <ul>
                        <li>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≥–æ–≤–æ—Ä–∏—Ç –û–°: "–†–∞–∑–±—É–¥–∏ –º–µ–Ω—è, –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —ç—Ç–æ—Ç —Å–æ–∫–µ—Ç" (—Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ <code>epoll</code> –≤ Linux, <code>kqueue</code> –≤ macOS, <code>IOCP</code> –≤ Windows).</li>
                        <li>–ü—Ä–æ–≥—Ä–∞–º–º–∞ "–∑–∞—Å—ã–ø–∞–µ—Ç" (–æ—Ç–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏–º –∑–∞–¥–∞—á–∞–º).</li>
                        <li>–ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç, –û–° –±—É–¥–∏—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É, Event Loop –≤–∏–¥–∏—Ç –≥–æ—Ç–æ–≤—ã–π —Å–æ–∫–µ—Ç –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π callback (–∏–ª–∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É).</li>
                    </ul>
                </div>
                <p>–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–æ—Ç–æ–∫–æ–≤, –≥–¥–µ –û–° —Å–∞–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç (Preemptive Multitasking), –≤ Asyncio –∑–∞–¥–∞—á–∏ —Å–∞–º–∏ –æ—Ç–¥–∞—é—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ <code>await</code> (Cooperative Multitasking). –ü–ª—é—Å: –Ω–µ—Ç –æ–≤–µ—Ä—Ö–µ–¥–∞ –Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ú–∏–Ω—É—Å: –æ–¥–Ω–∞ –∂–∞–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –∑–∞–≤–µ—Å–∏—Ç—å –≤–µ—Å—å —Ü–∏–∫–ª.</p>

                <h2>Structured Concurrency (TaskGroup)</h2>
                <p>–í Python 3.11+ –ø–æ—è–≤–∏–ª—Å—è `TaskGroup`. –≠—Ç–æ –∫–∞–∫ `try...except` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á. –ï—Å–ª–∏ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –ø–∞–¥–∞–µ—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è.</p>

                <p>–î–æ <code>TaskGroup</code> –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ <code>asyncio.gather()</code>. –ü—Ä–æ–±–ª–µ–º–∞ <code>gather</code> –≤ —Ç–æ–º, —á—Ç–æ –µ—Å–ª–∏ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ —É–ø–∞–ª–∞, –¥—Ä—É–≥–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å "–≤ –Ω–∏–∫—É–¥–∞" (orphan tasks), –∏–ª–∏ –∏—Ö —Å–ª–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å. <code>TaskGroup</code> –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–±–ª–æ–∫ <code>async with</code>) –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è, –ø–æ–∫–∞ –≤—Å–µ –¥–æ—á–µ—Ä–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è –∏–ª–∏ –Ω–µ –±—É–¥—É—Ç –æ—Ç–º–µ–Ω–µ–Ω—ã.</p>

<pre><code class="language-python">async def main():
    try:
        async with asyncio.TaskGroup() as tg:
            tg.create_task(task1())
            tg.create_task(db_query())
    except ExceptionGroup as e:
         # –í—Å–µ –æ—à–∏–±–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∑–¥–µ—Å—å
        print(f"Caught errors: {e}")
</code></pre>

                <h2>–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ (Semaphore)</h2>
                <p>–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ `await asyncio.gather(*[fetch(url) for url in urls])`, –≥–¥–µ 1000 url'–æ–≤, –≤—ã –ø–æ–ª–æ–∂–∏—Ç–µ –∏–ª–∏ —Å–µ—Ç—å, –∏–ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å.</p>

<pre><code class="language-python">sem = asyncio.Semaphore(10) # –ú–∞–∫—Å–∏–º—É–º 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

async def safe_fetch(url):
    async with sem:
        return await client.get(url)

await asyncio.gather(*[safe_fetch(u) for u in urls])
</code></pre>

                <h2>Asyncio vs Multiprocessing</h2>
                <p>Asyncio ‚Äî —ç—Ç–æ –ø—Ä–æ –æ–∂–∏–¥–∞–Ω–∏–µ (I/O bound). Multiprocessing ‚Äî —ç—Ç–æ –ø—Ä–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (CPU bound). –í Python –µ—Å—Ç—å GIL, –ø–æ—ç—Ç–æ–º—É –ø–æ—Ç–æ–∫–∏ –Ω–µ –ø–æ–º–æ–≥—É—Ç —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.</p>
                <ul>
                    <li><strong>I/O Bound (–°–µ—Ç—å, –î–∏—Å–∫, –ë–î):</strong> –ò—Å–ø–æ–ª—å–∑—É–µ–º `asyncio`. –≠—Ç–æ –±—ã—Å—Ç—Ä–æ, –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ (—Ç—ã—Å—è—á–∏ –∑–∞–¥–∞—á).</li>
                    <li><strong>CPU Bound (ML, –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è, –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫):</strong> –ò—Å–ø–æ–ª—å–∑—É–µ–º `multiprocessing`. –≠—Ç–æ —Ç—è–∂–µ–ª–æ (–æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã), –Ω–æ –æ–±—Ö–æ–¥–∏—Ç GIL.</li>
                </ul>

                <h3>ProcessPoolExecutor</h3>
                <p>–ß—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç—è–∂–µ–ª—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å Event Loop, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—É–ª –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.</p>

<pre><code class="language-python">from concurrent.futures import ProcessPoolExecutor
import asyncio

def cpu_heavy_function(data):
    # –î–æ–ª–≥–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
    return sum(range(data))

async def main():
    loop = asyncio.get_running_loop()
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    with ProcessPoolExecutor() as pool:
        result = await loop.run_in_executor(pool, cpu_heavy_function, 10_000_000)
    print(result)
</code></pre>

                <h2>Blocking Code in Asyncio</h2>
                <p>–ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —É–º–µ–µ—Ç async (–Ω–∞–ø—Ä–∏–º–µ—Ä, requests, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π open(), cpu-bound –∑–∞–¥–∞—á–∞). –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å Event Loop –Ω–µ–ª—å–∑—è!</p>

<pre><code class="language-python"># –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –≤—ã–Ω–æ—Å–∏–º –≤ thread pool
result = await asyncio.to_thread(sync_function, arg1)
</code></pre>

                <h2>Graceful Shutdown</h2>
                <p>–ö–æ–≥–¥–∞ Kubernetes —É–±–∏–≤–∞–µ—Ç –ø–æ–¥, –æ–Ω —à–ª–µ—Ç SIGTERM. –£ –≤–∞—Å –µ—Å—Ç—å 30 —Å–µ–∫—É–Ω–¥, —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã.</p>
                <ol>
                    <li>–ü–æ–π–º–∞—Ç—å SIGTERM.</li>
                    <li>–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–µ–º –Ω–æ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π.</li>
                    <li>–û—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ `BackgroundTasks`.</li>
                    <li>–î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.</li>
                    <li>–ó–∞–∫—Ä—ã—Ç—å –∫–æ–Ω–Ω–µ–∫—Ç—ã –∫ –ë–î.</li>
                    <li>–í—ã–π—Ç–∏.</li>
                </ol>

            <span class="keyword">await</span> asyncio.sleep(self._buffer.flush_interval)</code></pre>

                <h2>ü™® –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏</h2>
                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <strong>1. Garbage Collection —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á</strong>
                        </div>
                        <div class="accordion-content">
                            <p>–ï—Å–ª–∏ –≤—ã –¥–µ–ª–∞–µ—Ç–µ <code>asyncio.create_task(db_op())</code> –∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, Garbage Collector –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è!). Python 3.14+ –æ–±–µ—â–∞–µ—Ç —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –Ω–æ –ø–æ–∫–∞ –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å—Å—ã–ª–∫–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π <code>set</code>.</p>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <strong>2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Event Loop</strong>
                        </div>
                        <div class="accordion-content">
                            <p>–û–¥–∏–Ω –≤—ã–∑–æ–≤ <code>requests.get()</code> –∏–ª–∏ <code>time.sleep(1)</code> –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –í–ï–°–¨ —Å–µ—Ä–≤–µ—Ä. –ù–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –Ω–∏–∫—Ç–æ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>asyncio.to_thread</code> –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ª–µ–≥–∞—Å–∏ –∫–æ–¥–∞.</p>
                        </div>
                    </div>
                </div>

                <h2>üí° –õ–∞–π—Ñ—Ö–∞–∫–∏</h2>
                <ul>
                    <li><strong>asyncio.shield():</strong> –ó–∞—â–∏—â–∞–µ—Ç –∑–∞–¥–∞—á—É –æ—Ç –æ—Ç–º–µ–Ω—ã. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–ª –±—Ä–∞—É–∑–µ—Ä –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–∞, Litestar –ø–æ—à–ª–µ—Ç CancelledError. –û–±–µ—Ä–Ω–∏—Ç–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é –≤ <code>shield</code>, —á—Ç–æ–±—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–æ—à–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞.</li>
                    <li><strong>uvloop:</strong> Drop-in –∑–∞–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å–æ–±—ã—Ç–∏–π. –ü—Ä–æ—Å—Ç–æ <code>uvloop.install()</code> ‚Äî –∏ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ Node.js.</li>
                    <li><strong>TaskGroup (Python 3.11):</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–º–µ—Å—Ç–æ <code>gather</code>. –≠—Ç–æ Structured Concurrency: –µ—Å–ª–∏ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –ø–∞–¥–∞–µ—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è, –∞ –æ—à–∏–±–∫–∏ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è.</li>
                </ul>

                <div class="task-box">
                    <h4>üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞</h4>
                    <ul class="task-list">
                        <li>–†–µ–∞–ª–∏–∑—É–π Graceful Shutdown –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞</li>
                        <li>–ù–∞–ø–∏—à–∏ worker pool –Ω–∞ asyncio.Queue</li>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π TaskGroup –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</li>
                        <li>–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π uvloop</li>
                    </ul>
                </div>
            </div>
        </main>
    </div>
</body>
</html>