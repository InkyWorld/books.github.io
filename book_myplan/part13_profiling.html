<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13.1 Profiling ‚Äî ScaleTrade</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="book-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="logo">
                    <div class="logo-icon">üìà</div>
                    <span>ScaleTrade</span>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">–í–≤–µ–¥–µ–Ω–∏–µ</div>
                    <a href="index.html" class="nav-link">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">–ß–∞—Å—Ç—å 13: Performance</div>
                    <a href="part13_profiling.html" class="nav-link active">13.1 Profiling</a>
                    <a href="part13_caching.html" class="nav-link">13.2 Caching</a>
                    <a href="part13_loadbalancing.html" class="nav-link">13.3 Load Balancing</a>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="breadcrumb">
                    <a href="index.html">ScaleTrade</a>
                    <span>/</span>
                    <span>–ß–∞—Å—Ç—å 13</span>
                    <span>/</span>
                    <span>13.1 Profiling</span>
                </div>
            </header>

            <div class="page-content">
                <h1>–ú–æ–¥—É–ª—å 13.1: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h1>
                <p class="lead">"–ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ‚Äî –∫–æ—Ä–µ–Ω—å –≤—Å–µ—Ö –∑–æ–ª". –ù–æ –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –≥–æ—Ä–∏—Ç, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ. –£—á–∏–º—Å—è –∏—Å–∫–∞—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞.</p>

                <h2>–ß—Ç–æ –º—ã –∏—â–µ–º? (Bottlenecks)</h2>
                <ul>
                    <li><strong>CPU Bound:</strong> –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ 100%. –°–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON, –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è.</li>
                    <li><strong>I/O Bound:</strong> –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç, –∂–¥—ë–º —Å–µ—Ç—å –∏–ª–∏ –¥–∏—Å–∫. –ë–î –∑–∞–ø—Ä–æ—Å—ã, –≤–Ω–µ—à–Ω–∏–µ API, —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤.</li>
                    <li><strong>Memory Bound:</strong> –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ (Memory Leaks), —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–∫—Ç—ã. –í–µ–¥—ë—Ç –∫ —Å–≤–æ–ø—É –∏ OOMKill.</li>
                </ul>

                <h2>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è Python</h2>

                <h3>1. cProfile + SnakeViz</h3>
                <p>–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ –∏ –≤—Ä–µ–º—è.</p>
                <div class="code-block">
                    <pre><code>python -m cProfile -o output.prof myscript.py
pip install snakeviz
snakeviz output.prof</code></pre>
                </div>
                <p><em>–ú–∏–Ω—É—Å:</em> –ó–∞–º–µ–¥–ª—è–µ—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞. –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.</p>

                <h3>2. py-spy (Sampling Profiler)</h3>
                <p>–ö–∏–ª–ª–µ—Ä-—Ñ–∏—á–∞. –†–∞–±–æ—Ç–∞–µ—Ç —Å <strong>—É–∂–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º</strong> –ø—Ä–æ—Ü–µ—Å—Å–æ–º –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ—á—Ç–∏ –±–µ–∑ –æ–≤–µ—Ä—Ö–µ–¥–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞–≥–∏—é Linux eBPF/ptrace.</p>
                <div class="code-block">
                    <pre><code># Top-like live view
py-spy top --pid 12345

# Flamegraph generation
py-spy record -o profile.svg --pid 12345</code></pre>
                </div>
                <p><em>–ü–ª—é—Å:</em> –ú–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ –ø—Ä–æ–¥–µ.</p>

                <h3>3. Austin</h3>
                <p>–ï—â–µ –æ–¥–∏–Ω –º–æ—â–Ω—ã–π —Å—ç–º–ø–ª–∏—Ä—É—é—â–∏–π –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä, –æ—Ç–ª–∏—á–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å VS Code.</p>

                <h2>SQL Profiling (APM)</h2>
                <p>–ß–∞—Å—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –∫–æ–¥–µ, –∞ –≤ –±–∞–∑–µ. N+1 –ø—Ä–æ–±–ª–µ–º–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã.</p>
                <ul>
                    <li><strong>Django Debug Toolbar:</strong> –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É.</li>
                    <li><strong>Silk:</strong> –ñ–∏–≤–æ–π –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä –¥–ª—è Django, –ø–∏—à–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ë–î.</li>
                    <li><strong>Sentry / Datadog / New Relic:</strong> APM (Application Performance Monitoring) —Å–∏—Å—Ç–µ–º—ã. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—Ç —Ç—Ä–µ–π—Å—ã (Traces) –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫–æ–π —Å–ø–∞–Ω (Span) —Ç–æ—Ä–º–æ–∑–∏—Ç (–ë–î, Redis, –≤–Ω–µ—à–Ω–∏–π API).</li>
                </ul>

                <h2>ü™® –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏</h2>
                <div class="info-box danger">
                    <div class="info-box-title">–û—à–∏–±–∫–∏ –Ω–æ–≤–∏—á–∫–∞</div>
                    <ul>
                        <li>–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞—Ç—å –≤ Debug —Ä–µ–∂–∏–º–µ (–æ–Ω –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏ –≤–µ–¥–µ—Ç —Å–µ–±—è –∏–Ω–∞—á–µ).</li>
                        <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –∏–∑–º–µ—Ä–µ–Ω–∏–π ("–ú–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —Ç—É—Ç –º–µ–¥–ª–µ–Ω–Ω–æ").</li>
                        <li>–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å Network Latency (–ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ —Å –ë–î –Ω–∞ localhost, –∫–æ–≥–¥–∞ –Ω–∞ –ø—Ä–æ–¥–µ –¥–æ –ë–î 10–º—Å).</li>
                    </ul>
                </div>
            </div>
        </main>
    </div>
</body>
</html>