<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7.1 GraphQL API ‚Äî ScaleTrade</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="book-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="logo">
                    <div class="logo-icon">üìà</div>
                    <span>ScaleTrade</span>
                </a>
            </div>
            <nav class="sidebar-nav">
    <div class="nav-section">
        <div class="nav-section-title">Intro</div>
        <a href="index.html" class="nav-link">üè† –ì–ª–∞–≤–Ω–∞—è</a>
        <a href="setup.html" class="nav-link">üõ† Setup</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 0: Fundamentals</div>
        <a href="part0_internals.html" class="nav-link">0.1 Internals</a>
        <a href="part0_networking.html" class="nav-link">0.2 Networking</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 1: Postgres</div>
        <a href="part1_schema.html" class="nav-link">1.1 Schema</a>
        <a href="part1_indexes.html" class="nav-link">1.2 Indexes</a>
        <a href="part1_transactions.html" class="nav-link">1.3 Transactions</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 2: Litestar</div>
        <a href="part2_litestar.html" class="nav-link">2.1 Framework</a>
        <a href="part2_dishka.html" class="nav-link">2.2 DI (Dishka)</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 3: Brokers</div>
        <a href="part3_redis.html" class="nav-link">3.1 Redis</a>
        <a href="part3_faststream.html" class="nav-link">3.2 FastStream</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 4: Quality</div>
        <a href="part4_testing.html" class="nav-link">4.1 Pytest</a>
        <a href="part4_resiliency.html" class="nav-link">4.2 Resilience</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 5: Observability</div>
        <a href="part5_clickhouse.html" class="nav-link">5.1 Clickhouse</a>
        <a href="part5_logging.html" class="nav-link">5.2 Structured Logs</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 6: Django</div>
        <a href="part6_django.html" class="nav-link">6.1 ORM</a>
        <a href="part6_migrations.html" class="nav-link">6.2 Migrations</a>
        <a href="part6_quality.html" class="nav-link">6.3 Quality</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 7: Microservices</div>
        <a href="part7_grpc.html" class="nav-link">7.1 gRPC</a>
        <a href="part7_graphql.html" class="nav-link active">7.2 GraphQL</a>
        <a href="part7_federation.html" class="nav-link">7.3 Federation</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 8: Async</div>
        <a href="part8_asyncio.html" class="nav-link">8.1 Asyncio</a>
        <a href="part8_celery.html" class="nav-link">8.2 Celery</a>
        <a href="part8_dramatiq.html" class="nav-link">8.3 Dramatiq</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 9: API</div>
        <a href="part9_restdesign.html" class="nav-link">9.1 REST Design</a>
        <a href="part9_idempotency.html" class="nav-link">9.2 Idempotency</a>
        <a href="part9_openapi.html" class="nav-link">9.3 OpenAPI</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 10: Culture</div>
        <a href="part10_git.html" class="nav-link">10.1 Git</a>
        <a href="part10_commits.html" class="nav-link">10.2 Commits</a>
        <a href="part10_codereview.html" class="nav-link">10.3 Post-Review</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 11: Security</div>
        <a href="part11_oauth.html" class="nav-link">11.1 OAuth2</a>
        <a href="part11_vault.html" class="nav-link">11.2 Vault</a>
        <a href="part11_owasp.html" class="nav-link">11.3 OWASP</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 12: Kubernetes</div>
        <a href="part12_kubernetes.html" class="nav-link">12.1 K8s Basics</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 13: High Load</div>
        <a href="part13_profiling.html" class="nav-link">13.1 Profiling</a>
        <a href="part13_caching.html" class="nav-link">13.2 Caching</a>
        <a href="part13_loadbalancing.html" class="nav-link">13.3 Load Balancing</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 14: ML Ops</div>
        <a href="part14_mlflow.html" class="nav-link">14.1 MLflow</a>
        <a href="part14_embeddings.html" class="nav-link">14.2 Embeddings</a>
        <a href="part14_llm.html" class="nav-link">14.3 LLM</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 15: Debugging</div>
        <a href="part15_debugging.html" class="nav-link">15.1 Debugging</a>
        <a href="part15_postmortem.html" class="nav-link">15.2 Postmortem</a>
        <a href="part15_chaos.html" class="nav-link">15.3 Chaos Eng</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 16: DB Advanced</div>
        <a href="part16_indexes.html" class="nav-link">16.1 Indexes Deep</a>
        <a href="part16_isolation.html" class="nav-link">16.2 Isolation</a>
        <a href="part16_sharding.html" class="nav-link">16.3 Sharding</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 17: System Design</div>
        <a href="part17_circuit.html" class="nav-link">17.1 Circuit Breaker</a>
        <a href="part17_ratelimit.html" class="nav-link">17.2 Rate Limit</a>
        <a href="part17_distlock.html" class="nav-link">17.3 Dist Lock</a>
    </div>
    <div class="nav-section">
        <div class="nav-section-title">Part 18: Soft Skills</div>
        <a href="part18_estimation.html" class="nav-link">18.1 Estimation</a>
        <a href="part18_burnout.html" class="nav-link">18.2 Burnout</a>
        <a href="part18_interview.html" class="nav-link">18.3 Interview</a>
    </div>
</nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="breadcrumb">
                    <a href="index.html">ScaleTrade</a>
                    <span>/</span>
                    <span>–ß–∞—Å—Ç—å 7</span>
                    <span>/</span>
                    <span>7.1 GraphQL API</span>
                </div>
            </header>

            <div class="page-content">
                <h1>–ú–æ–¥—É–ª—å 7.1: GraphQL API —Å Strawberry</h1>
                <p class="lead">
                    –°—Ç—Ä–æ–∏–º —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π GraphQL API: —Å—Ö–µ–º—ã, —Ä–µ–∑–æ–ª–≤–µ—Ä—ã, DataLoader –¥–ª—è N+1, –ø–æ–¥–ø–∏—Å–∫–∏.
                </p>

                <div class="info-box tip">
                    <div class="info-box-title">üí° –ó–∞—á–µ–º GraphQL?</div>
                    <ul>
                        <li>–ö–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è ‚Äî —ç–∫–æ–Ω–æ–º–∏–º —Ç—Ä–∞—Ñ–∏–∫</li>
                        <li>–û–¥–∏–Ω endpoint –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ REST routes</li>
                        <li>–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–∑ –∫–æ—Ä–æ–±–∫–∏ —Å introspection</li>
                        <li>Real-time –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è live updates</li>
                    </ul>
                </div>

                <h2>Strawberry GraphQL</h2>
                <p>
                    Strawberry ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è GraphQL —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π type hints.
                </p>

                <pre><code class="language-bash">poetry add strawberry-graphql[litestar] strawberry-sqlalchemy-mapper</code></pre>

                <h2>GraphQL —Å—Ö–µ–º–∞ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã</h2>

                <pre><code class="language-python"># domain/entities/order.py
from dataclasses import dataclass
from decimal import Decimal
from datetime import datetime
from enum import Enum
import strawberry

@strawberry.enum
class OrderSide(str, Enum):
    BUY = "BUY"
    SELL = "SELL"

@strawberry.enum
class OrderStatus(str, Enum):
    PENDING = "PENDING"
    FILLED = "FILLED"
    PARTIALLY_FILLED = "PARTIALLY_FILLED"
    CANCELLED = "CANCELLED"

@strawberry.type
class Order:
    id: strawberry.ID
    user_id: int
    symbol: str
    side: OrderSide
    quantity: Decimal
    price: Decimal
    filled_quantity: Decimal
    status: OrderStatus
    created_at: datetime
    updated_at: datetime
    
    @strawberry.field
    def total_value(self) -> Decimal:
        """–í—ã—á–∏—Å–ª—è–µ–º–æ–µ –ø–æ–ª–µ"""
        return self.quantity * self.price
    
    @strawberry.field
    async def user(self, info) -> "User":
        """–°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ DataLoader"""
        return await info.context["user_loader"].load(self.user_id)
    
    @strawberry.field
    async def executions(self, info) -> list["Execution"]:
        """–°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–π –æ—Ä–¥–µ—Ä–∞"""
        return await info.context["execution_loader"].load(self.id)</code></pre>

                <h2>Resolver —Å DataLoader (—Ä–µ—à–µ–Ω–∏–µ N+1 –ø—Ä–æ–±–ª–µ–º—ã)</h2>

                <pre><code class="language-python"># interface/graphql/loaders.py
from strawberry.dataloader import DataLoader
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select

class UserLoader(DataLoader):
    def __init__(self, session: AsyncSession):
        super().__init__()
        self.session = session
    
    async def load(self, keys: list[int]) -> list[User]:
        """–ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        stmt = select(UserModel).where(UserModel.id.in_(keys))
        result = await self.session.execute(stmt)
        users = result.scalars().all()
        
        # –°–æ–∑–¥–∞–µ–º –º–∞–ø–ø–∏–Ω–≥ id -> user –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
        user_map = {user.id: user for user in users}
        return [user_map.get(key) for key in keys]

# interface/graphql/resolvers/order.py
import strawberry
from typing import Optional
from decimal import Decimal

@strawberry.type
class Query:
    @strawberry.field
    async def order(self, info, id: strawberry.ID) -> Optional[Order]:
        """–ü–æ–ª—É—á–∏—Ç—å –æ—Ä–¥–µ—Ä –ø–æ ID"""
        order_service = info.context["order_service"]
        order_entity = await order_service.get_by_id(int(id))
        return Order.from_entity(order_entity) if order_entity else None
    
    @strawberry.field
    async def orders(
        self,
        info,
        user_id: Optional[int] = None,
        symbol: Optional[str] = None,
        status: Optional[OrderStatus] = None,
        limit: int = 100
    ) -> list[Order]:
        """–°–ø–∏—Å–æ–∫ –æ—Ä–¥–µ—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏"""
        order_service = info.context["order_service"]
        filters = {}
        if user_id:
            filters["user_id"] = user_id
        if symbol:
            filters["symbol"] = symbol
        if status:
            filters["status"] = status
        
        entities = await order_service.list_orders(filters, limit=limit)
        return [Order.from_entity(e) for e in entities]</code></pre>

                <h2>Mutations –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤</h2>

                <pre><code class="language-python"># interface/graphql/resolvers/mutations.py
import strawberry
from decimal import Decimal

@strawberry.input
class CreateOrderInput:
    symbol: str
    side: OrderSide
    quantity: Decimal
    price: Decimal

@strawberry.type
class CreateOrderPayload:
    order: Order
    errors: Optional[list[str]] = None

@strawberry.type
class Mutation:
    @strawberry.mutation
    async def create_order(
        self,
        info,
        input: CreateOrderInput
    ) -> CreateOrderPayload:
        """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ—Ä–¥–µ—Ä"""
        try:
            order_service = info.context["order_service"]
            user_id = info.context["current_user"].id
            
            order_entity = await order_service.create_order(
                user_id=user_id,
                symbol=input.symbol,
                side=input.side,
                quantity=input.quantity,
                price=input.price
            )
            
            return CreateOrderPayload(
                order=Order.from_entity(order_entity)
            )
        except ValueError as e:
            return CreateOrderPayload(
                order=None,
                errors=[str(e)]
            )
    
    @strawberry.mutation
    async def cancel_order(
        self,
        info,
        order_id: strawberry.ID
    ) -> CreateOrderPayload:
        """–û—Ç–º–µ–Ω–∏—Ç—å –æ—Ä–¥–µ—Ä"""
        order_service = info.context["order_service"]
        user_id = info.context["current_user"].id
        
        order_entity = await order_service.cancel_order(
            order_id=int(order_id),
            user_id=user_id
        )
        
        return CreateOrderPayload(
            order=Order.from_entity(order_entity)
        )</code></pre>

                <h2>Real-time –ø–æ–¥–ø–∏—Å–∫–∏ (WebSocket)</h2>

                <pre><code class="language-python"># interface/graphql/subscriptions.py
import strawberry
import asyncio
from typing import AsyncGenerator

@strawberry.type
class Subscription:
    @strawberry.subscription
    async def order_updates(
        self,
        info,
        user_id: int
    ) -> AsyncGenerator[Order, None]:
        """–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        redis = info.context["redis"]
        pubsub = redis.pubsub()
        
        await pubsub.subscribe(f"orders:user:{user_id}")
        
        try:
            async for message in pubsub.listen():
                if message["type"] == "message":
                    order_data = json.loads(message["data"])
                    yield Order.from_dict(order_data)
        finally:
            await pubsub.unsubscribe(f"orders:user:{user_id}")
    
    @strawberry.subscription
    async def price_feed(
        self,
        info,
        symbols: list[str]
    ) -> AsyncGenerator["PriceTick", None]:
        """–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω"""
        redis = info.context["redis"]
        pubsub = redis.pubsub()
        
        channels = [f"price:{symbol}" for symbol in symbols]
        await pubsub.subscribe(*channels)
        
        try:
            async for message in pubsub.listen():
                if message["type"] == "message":
                    price_data = json.loads(message["data"])
                    yield PriceTick(
                        symbol=price_data["symbol"],
                        price=Decimal(price_data["price"]),
                        timestamp=datetime.fromisoformat(price_data["timestamp"])
                    )
        finally:
            await pubsub.unsubscribe(*channels)</code></pre>

                <h2>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Litestar</h2>

                <pre><code class="language-python"># interface/http/app.py
from litestar import Litestar
from strawberry.litestar import make_graphql_controller
import strawberry

schema = strawberry.Schema(
    query=Query,
    mutation=Mutation,
    subscription=Subscription
)

graphql_controller = make_graphql_controller(
    schema,
    path="/graphql",
    graphiql=True  # GraphiQL playground
)

async def create_graphql_context(request):
    """–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Ä–µ–∑–æ–ª–≤–µ—Ä–æ–≤"""
    return {
        "request": request,
        "current_user": request.user,
        "order_service": request.app.state.order_service,
        "user_loader": UserLoader(request.app.state.db_session),
        "execution_loader": ExecutionLoader(request.app.state.db_session),
        "redis": request.app.state.redis
    }

app = Litestar(
    route_handlers=[graphql_controller],
    on_app_init=[setup_di]
)</code></pre>

                <h2>–§—Ä–∞–≥–º–µ–Ω—Ç—ã –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã</h2>

                <pre><code class="language-graphql"># –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å —Å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏
fragment OrderFields on Order {
  id
  symbol
  side
  quantity
  price
  totalValue
  status
  createdAt
}

query GetUserOrders($userId: Int!) {
  orders(userId: $userId, limit: 50) {
    ...OrderFields
    user {
      id
      email
    }
    executions {
      id
      executedQuantity
      executedPrice
      timestamp
    }
  }
}

mutation PlaceOrder($input: CreateOrderInput!) {
  createOrder(input: $input) {
    order {
      ...OrderFields
    }
    errors
  }
}

subscription WatchOrders($userId: Int!) {
  orderUpdates(userId: $userId) {
    ...OrderFields
  }
}</code></pre>

                <h2>Pagination —Å Relay Cursor</h2>

                <pre><code class="language-python"># interface/graphql/pagination.py
import strawberry
from typing import Generic, TypeVar, Optional
import base64

T = TypeVar("T")

@strawberry.type
class PageInfo:
    has_next_page: bool
    has_previous_page: bool
    start_cursor: Optional[str]
    end_cursor: Optional[str]

@strawberry.type
class Edge(Generic[T]):
    node: T
    cursor: str

@strawberry.type
class Connection(Generic[T]):
    edges: list[Edge[T]]
    page_info: PageInfo
    total_count: int

def encode_cursor(value: int) -> str:
    return base64.b64encode(f"cursor:{value}".encode()).decode()

def decode_cursor(cursor: str) -> int:
    decoded = base64.b64decode(cursor).decode()
    return int(decoded.split(":")[1])

@strawberry.type
class Query:
    @strawberry.field
    async def orders_connection(
        self,
        info,
        first: Optional[int] = 10,
        after: Optional[str] = None
    ) -> Connection[Order]:
        """–ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤ —Å—Ç–∏–ª–µ Relay"""
        order_service = info.context["order_service"]
        
        offset = decode_cursor(after) if after else 0
        limit = first + 1  # +1 –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ has_next_page
        
        orders = await order_service.list_orders(
            offset=offset,
            limit=limit
        )
        
        has_next = len(orders) > first
        if has_next:
            orders = orders[:first]
        
        edges = [
            Edge(
                node=Order.from_entity(order),
                cursor=encode_cursor(offset + i)
            )
            for i, order in enumerate(orders)
        ]
        
        return Connection(
            edges=edges,
            page_info=PageInfo(
                has_next_page=has_next,
                has_previous_page=offset > 0,
                start_cursor=edges[0].cursor if edges else None,
                end_cursor=edges[-1].cursor if edges else None
            ),
            total_count=await order_service.count_orders()
        )</code></pre>

                <h2>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GraphQL</h2>

                <pre><code class="language-python"># tests/interface/graphql/test_order_queries.py
import pytest
from httpx import AsyncClient

@pytest.mark.asyncio
async def test_query_orders(client: AsyncClient, auth_headers):
    query = """
        query {
            orders(limit: 5) {
                id
                symbol
                price
            }
        }
    """
    
    response = await client.post(
        "/graphql",
        json={"query": query},
        headers=auth_headers
    )
    
    assert response.status_code == 200
    data = response.json()
    assert "data" in data
    assert len(data["data"]["orders"]) <= 5

@pytest.mark.asyncio
async def test_create_order_mutation(client: AsyncClient, auth_headers):
    mutation = """
        mutation CreateOrder($input: CreateOrderInput!) {
            createOrder(input: $input) {
                order {
                    id
                    symbol
                    status
                }
                errors
            }
        }
    """
    
    variables = {
        "input": {
            "symbol": "BTCUSDT",
            "side": "BUY",
            "quantity": "0.1",
            "price": "50000.00"
        }
    }
    
    response = await client.post(
        "/graphql",
        json={"query": mutation, "variables": variables},
        headers=auth_headers
    )
    
    assert response.status_code == 200
    data = response.json()
    assert data["data"]["createOrder"]["errors"] is None
    assert data["data"]["createOrder"]["order"]["symbol"] == "BTCUSDT"</code></pre>


                <h2>ü™® –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏</h2>
                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <strong>1. –ü—Ä–æ–±–ª–µ–º–∞ N+1</strong>
                        </div>
                        <div class="accordion-content">
                            <p>–í GraphQL —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ ‚Ññ1. –ï—Å–ª–∏ –≤—ã –ø–∏—à–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∑–æ–ª–≤–µ—Ä <code>user { orders }</code>, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ –ë–î, —Ç–æ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —à–∫–≤–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <strong>DataLoader</strong> (<code>strawberry.dataloader</code>), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –±–∞—Ç—á–∏—Ç –∑–∞–ø—Ä–æ—Å—ã –ø–æ ID.</p>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <strong>2. DoS –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å</strong>
                        </div>
                        <div class="accordion-content">
                            <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å <code>{ me { friends { friends { ... } } } }</code> –≥–ª—É–±–∏–Ω–æ–π 100 —É—Ä–æ–≤–Ω–µ–π, –∏ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –ª—è–∂–µ—Ç. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é "Query Depth Limit" –∏ "Complexity Cost".</p>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <div class="accordion-header">
                            <strong>3. HTTP 200 OK –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö</strong>
                        </div>
                        <div class="accordion-content">
                            <p>GraphQL –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å 200, –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –ø–æ–ª–µ <code>errors</code> –ª–µ–∂–∏—Ç —Ç—Ä–µ–π—Å–±–µ–∫. –≠—Ç–æ –ª–æ–º–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ 5xx –∫–æ–¥—ã. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∏–¥–ª–≤–∞—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–∏—à–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞, –∞ –Ω–µ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥–∞.</p>
                        </div>
                    </div>
                </div>

                <h2>üí° –õ–∞–π—Ñ—Ö–∞–∫–∏</h2>
                <ul>
                    <li><strong>Persisted Queries:</strong> –ß—Ç–æ–±—ã –Ω–µ –≥–æ–Ω—è—Ç—å –ø–æ —Å–µ—Ç–∏ –æ–≥—Ä–æ–º–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ö–µ—à –∑–∞–ø—Ä–æ—Å–∞. –ë—ç–∫–µ–Ω–¥ –∏—â–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ —Ö–µ—à—É –≤ Redis. –≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.</li>
                    <li><strong>Codegen:</strong> –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é TypeScript —Ç–∏–ø–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –∏–∑ –≤–∞—à–µ–π <code>schema.graphql</code>. –≠—Ç–æ —Å–ø–∞—Å–µ—Ç –æ—Ç –æ–ø–µ—á–∞—Ç–æ–∫ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –ø–æ–ª–µ–π ("user_id" vs "userId").</li>
                    <li><strong>Altair Client:</strong> –ì–æ—Ä–∞–∑–¥–æ —É–¥–æ–±–Ω–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ GraphiQL. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, —ç–Ω–≤–∞–π—Ä–æ–Ω–º–µ–Ω—Ç—ã –∏ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤.</li>
                </ul>

                <div class="task-box">
                    <h4>üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞</h4>
                    <ul class="task-list">
                        <li>–†–µ–∞–ª–∏–∑—É–π GraphQL —Å—Ö–µ–º—É –¥–ª—è Order –∏ User</li>
                        <li>–î–æ–±–∞–≤—å DataLoader –¥–ª—è —Ä–µ—à–µ–Ω–∏—è N+1 –ø—Ä–æ–±–ª–µ–º—ã</li>
                        <li>–°–æ–∑–¥–∞–π mutation –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ—Ç–º–µ–Ω—ã –æ—Ä–¥–µ—Ä–æ–≤</li>
                        <li>–ù–∞—Å—Ç—Ä–æ–π WebSocket –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è</li>
                        <li>–î–æ–±–∞–≤—å Relay-style –ø–∞–≥–∏–Ω–∞—Ü–∏—é</li>
                    </ul>
                </div>

                <div class="nav-footer">
                    <a href="part6_django.html">
                        <div>
                            <div class="nav-label">–ù–∞–∑–∞–¥</div>
                            <div class="nav-title">‚Üê 6.3 Django Admin</div>
                        </div>
                    </a>
                    <a href="part7_grpc.html">
                        <div>
                            <div class="nav-label">–î–∞–ª–µ–µ</div>
                            <div class="nav-title">7.2 gRPC Services ‚Üí</div>
                        </div>
                    </a>
                </div>
            </div>
        </main>
    </div>
</body>
</html>
